<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>محول الأعداد: ثنائي وعشري</title>
    <!-- تحميل Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- تعيين الخط وبعض الإعدادات الافتراضية لـ Tailwind -->
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap");
      body {
        font-family: "Cairo", sans-serif;
        background-color: #f3f4f6;
      }
      /* تصميم الجدول ليكون واضحاً وجميلاً */
      .conversion-table th,
      .conversion-table td {
        padding: 8px 12px;
        text-align: center;
      }
      .conversion-table th {
        background-color: #10b981; /* green-500 */
        color: white;
        font-weight: bold;
      }
      .conversion-table td {
        border-bottom: 1px solid #d1d5db; /* gray-300 */
      }
      .conversion-table tr:last-child td {
        border-bottom: none;
      }
    </style>
  </head>
  <body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto bg-white shadow-xl rounded-xl p-6 md:p-10">
      <!-- العنوان الرئيسي -->
      <h1
        class="text-3xl font-bold text-center text-indigo-700 mb-8 border-b-2 pb-2"
      >
        محول الأعداد (ثنائي &harr; عشري)
      </h1>

      <!-- حاوية الأقسام -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- القسم الأول: من ثنائي إلى عشري -->
        <div
          id="binary-to-decimal-card"
          class="bg-indigo-50 p-6 rounded-xl shadow-lg transition duration-300 hover:shadow-2xl"
        >
          <h2 class="text-xl font-bold text-indigo-600 mb-4">
            من ثنائي إلى عشري
          </h2>
          <div class="mb-4">
            <label
              for="binaryInput"
              class="block text-sm font-medium text-gray-700 mb-1"
              >أدخل عدد ثنائي:</label
            >
            <input
              type="text"
              id="binaryInput"
              placeholder="مثل: 10110"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-left"
              dir="ltr"
            />
          </div>
          <button
            onclick="convertBinaryToDecimal()"
            class="w-full bg-indigo-500 text-white py-2 rounded-lg font-semibold hover:bg-indigo-600 transition duration-150 shadow-md"
          >
            تحويل إلى عشري
          </button>

          <div class="mt-6 p-4 bg-white rounded-lg border border-indigo-200">
            <h3 class="text-lg font-bold text-indigo-700 mb-2">
              النتيجة العشرية:
            </h3>
            <p
              id="decimalResult"
              class="text-2xl font-mono text-gray-800 text-left"
              dir="ltr"
            >
              0
            </p>
          </div>

          <!-- خطوات الحل للتحويل من ثنائي لعشري -->
          <div class="mt-6 border-t pt-4">
            <h3 class="text-lg font-bold text-gray-800 mb-2">خطوات الحل</h3>
            <div
              id="binarySteps"
              class="bg-white p-3 rounded-lg border border-gray-300 min-h-[50px] overflow-x-auto text-sm text-gray-700 whitespace-pre-wrap"
            >
              <!-- سيتم عرض الخطوات هنا -->
              أدخل العدد الثنائي للبدء.
            </div>
          </div>
        </div>

        <!-- القسم الثاني: من عشري إلى ثنائي -->
        <div
          id="decimal-to-binary-card"
          class="bg-green-50 p-6 rounded-xl shadow-lg transition duration-300 hover:shadow-2xl"
        >
          <h2 class="text-xl font-bold text-green-600 mb-4">
            من عشري إلى ثنائي
          </h2>
          <div class="mb-4">
            <label
              for="decimalInput"
              class="block text-sm font-medium text-gray-700 mb-1"
              >أدخل عدد عشري صحيح:</label
            >
            <input
              type="number"
              id="decimalInput"
              placeholder="مثل: 22"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-left"
              dir="ltr"
            />
          </div>
          <button
            onclick="convertDecimalToBinary()"
            class="w-full bg-green-500 text-white py-2 rounded-lg font-semibold hover:bg-green-600 transition duration-150 shadow-md"
          >
            تحويل إلى ثنائي
          </button>

          <div class="mt-6 p-4 bg-white rounded-lg border border-green-200">
            <h3 class="text-lg font-bold text-green-700 mb-2">
              النتيجة الثنائية:
            </h3>
            <p
              id="binaryResult"
              class="text-2xl font-mono text-gray-800 text-left"
              dir="ltr"
            >
              0
            </p>
          </div>

          <!-- خطوات الحل للتحويل من عشري لثنائي -->
          <div class="mt-6 border-t pt-4">
            <h3 class="text-lg font-bold text-gray-800 mb-2">خطوات الحل</h3>
            <div
              id="decimalSteps"
              class="bg-white p-3 rounded-lg border border-gray-300 min-h-[50px] overflow-x-auto text-sm text-gray-700 whitespace-pre-wrap"
            >
              <!-- سيتم عرض الخطوات هنا -->
              أدخل العدد العشري للبدء.
            </div>
          </div>
        </div>
      </div>

      <!-- رسالة الخطأ (تستخدم لإظهار الأخطاء بدل Alert) -->
      <div
        id="errorMessage"
        class="fixed bottom-4 left-1/2 transform -translate-x-1/2 p-4 bg-red-600 text-white rounded-lg shadow-xl hidden transition-opacity duration-300 z-50"
      >
        <!-- محتوى الخطأ هنا -->
      </div>
    </div>

    <script>
      // دالة لعرض رسالة خطأ مؤقتة (بدلاً من alert)
      function showMessage(message, isError = true) {
        const msgBox = document.getElementById("errorMessage");
        msgBox.textContent = message;
        msgBox.className = `fixed bottom-4 left-1/2 transform -translate-x-1/2 p-4 text-white rounded-lg shadow-xl transition-opacity duration-300 z-50 ${
          isError ? "bg-red-600" : "bg-green-600"
        } block`;
        setTimeout(() => {
          msgBox.classList.add("hidden");
        }, 5000);
      }

      // =============================================================
      // دالة التحويل من ثنائي إلى عشري
      // =============================================================
      function convertBinaryToDecimal() {
        const binaryInput = document.getElementById("binaryInput").value.trim();
        const decimalResultElement = document.getElementById("decimalResult");
        const stepsElement = document.getElementById("binarySteps");

        // 1. التحقق من صحة الإدخال (يجب أن يحتوي فقط على 0 و 1)
        if (!/^[01]+$/.test(binaryInput) || binaryInput === "") {
          decimalResultElement.textContent = "خطأ";
          stepsElement.textContent =
            "خطأ: يرجى إدخال أرقام ثنائية فقط (0 و 1).";
          showMessage("خطأ: يرجى إدخال أرقام ثنائية صحيحة.", true);
          return;
        }

        let decimalValue = 0;
        let steps =
          "نبدأ من اليمين (المنزلة الأقل وزناً) ونضرب كل رقم ثنائي في قوة الأساس 2 المقابلة لمنزلته. \n\n";
        const binaryReversed = binaryInput.split("").reverse();

        // الصيغة الرياضية الكاملة
        let formula = binaryReversed
          .map((digit, index) => {
            return `${digit} \u00D7 2^${index}`; // \u00D7 هو رمز الضرب ×
          })
          .reverse()
          .join(" + ");

        steps += `الصيغة: ${formula} \n\n`;
        steps += "==================================== \n";

        // حساب القيمة وخطوات الجمع
        let calculationSteps = "";
        binaryReversed.forEach((digit, index) => {
          const powerOfTwo = Math.pow(2, index);
          const value = parseInt(digit) * powerOfTwo;
          decimalValue += value;

          calculationSteps += `| المنزلة ${index}: (${digit}) \u00D7 2^${index} = (${digit}) \u00D7 ${powerOfTwo} = ${value} \n`;
        });

        steps += calculationSteps;
        steps += "==================================== \n";

        steps += `النتيجة النهائية (مجموع القيم): ${decimalValue} (عشري) \n`;

        // عرض النتيجة والخطوات
        decimalResultElement.textContent = decimalValue;
        stepsElement.textContent = steps;
      }

      // =============================================================
      // دالة التحويل من عشري إلى ثنائي (تم تحديثها لعرض جدول)
      // =============================================================
      function convertDecimalToBinary() {
        const decimalInputStr = document
          .getElementById("decimalInput")
          .value.trim();
        const binaryResultElement = document.getElementById("binaryResult");
        const stepsElement = document.getElementById("decimalSteps");

        const decimalInput = parseInt(decimalInputStr);

        // 1. التحقق من صحة الإدخال (يجب أن يكون عدد صحيح غير سالب)
        if (
          isNaN(decimalInput) ||
          decimalInput < 0 ||
          decimalInput.toString() !== decimalInputStr
        ) {
          binaryResultElement.textContent = "خطأ";
          stepsElement.innerHTML = "خطأ: يرجى إدخال عدد عشري صحيح غير سالب.";
          showMessage("خطأ: يرجى إدخال عدد عشري صحيح غير سالب.", true);
          return;
        }

        if (decimalInput === 0) {
          binaryResultElement.textContent = "0";
          stepsElement.innerHTML =
            "العدد العشري هو 0، وبالتالي العدد الثنائي هو 0.";
          return;
        }

        let tempDecimal = decimalInput;
        let binaryDigits = [];
        let tableHTML = `
                <p class="mb-3">نقسم العدد العشري بشكل متكرر على 2، ونسجل الباقي (الرقم الثنائي).</p>
                <div class="overflow-x-auto rounded-lg shadow">
                    <table class="conversion-table w-full border-collapse">
                        <thead>
                            <tr>
                                <th class="rounded-tr-lg">العدد العشري</th>
                                <th>خارج القسمة (\u00F7 2)</th>
                                <th class="rounded-tl-lg">الباقي (الرقم الثنائي)</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

        while (tempDecimal > 0) {
          const currentNumber = tempDecimal;
          const remainder = tempDecimal % 2;
          const quotient = Math.floor(tempDecimal / 2);

          tableHTML += `
                    <tr class="hover:bg-green-100 transition duration-100">
                        <td class="font-mono">${currentNumber}</td>
                        <td class="font-mono">${quotient}</td>
                        <td class="font-mono text-green-700 font-bold">${remainder}</td>
                    </tr>
                `;

          binaryDigits.push(remainder);
          tempDecimal = quotient;
        }

        tableHTML += "</tbody></table></div>";

        const binaryResult = binaryDigits.reverse().join("");

        tableHTML += `
                <div class="mt-4 p-3 bg-green-100 rounded-lg border border-green-300">
                    <p class="font-bold text-green-800">النتيجة النهائية (بقراءة البواقي من الأسفل للأعلى):</p>
                    <p class="text-xl font-mono text-green-900 mt-1">${binaryResult} (ثنائي)</p>
                </div>
            `;

        // عرض النتيجة والخطوات
        binaryResultElement.textContent = binaryResult;
        stepsElement.innerHTML = tableHTML;
      }

      // تشغيل دالة التحويل عند تحميل الصفحة لأول مرة لإظهار النتيجة الافتراضية
      window.onload = function () {
        // قم بتعيين قيم افتراضية قبل التشغيل
        document.getElementById("binaryInput").value = "10110";
        document.getElementById("decimalInput").value = "22";

        convertBinaryToDecimal();
        convertDecimalToBinary();
      };
    </script>
  </body>
</html>
